<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org" class="dark h-100" data-bs-theme="dark">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Mathis - Welcome page</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/styles/cashflow.css}"/>
</head>
<body class="d-flex h-100 text-center text-bg-white">

<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header class="mb-auto">
        <img th:src="@{/images/mathis.png}" alt="Mathis Logo" style="width: 150px;">
        <h1>CashFlow Editing</h1>
    </header>
    <main class="px-3">

		<form th:action="@{/web/cashflow/update/{year}(year=${year})}" method="post">
		    <table class="report-table">
		        <thead>
		            <tr>
		                <th>Data Reg.</th>
		                <th>Descrizione</th>
		                <th>n° e data doc.</th>
		                <th>Voce</th>
		                <th class="cassa-entrate-header">CASSA&gt; ENTRATE (A)</th>
		                <th class="cassa-uscite-header">CASSA&gt; USCITE (B)</th>
		                <th class="banca-entrate-header">BANCA&gt; ENTRATE (A)</th>
		                <th class="banca-uscite-header">BANCA&gt; USCITE (B)</th>
		            </tr>
		            <tr>
		                <td colspan="4" class="residui-header">Residui anno precedente</td>
		                <td class="residui-value" th:text="${initialCashBalance &gt; 0} ? |€ ${#numbers.formatDecimal(initialCashBalance, 1, 'COMMA', 2, 'POINT')}| : ''"></td>
		                <td class="residui-value" th:text="${initialCashBalance &lt; 0} ? |€ ${#numbers.formatDecimal(initialCashBalance.abs(), 1, 'COMMA', 2, 'POINT')}| : ''"></td>
		                <td class="residui-value" th:text="${initialBankBalance &gt; 0} ? |€ ${#numbers.formatDecimal(initialBankBalance, 1, 'COMMA', 2, 'POINT')}| : ''"></td>
		                <td class="residui-value" th:text="${initialBankBalance &lt; 0} ? |€ ${#numbers.formatDecimal(initialBankBalance.abs(), 1, 'COMMA', 2, 'POINT')}| : ''"></td>
		            </tr>
		        </thead>
		        <tbody>
		            <tr th:each="transaction, iter : ${transactions}">
		                <input type="hidden" th:name="'transactions[' + ${iter.index} + '].id'" th:value="${transaction.id}" />

		                <!-- Data -->
		                <td>
		                    <input type="date"
		                        class="form-control form-control-sm"
		                        th:name="'transactions[' + ${iter.index} + '].date'"
		                        th:value="${transaction.date}" />
		                </td>

		                <!-- Descrizione -->
		                <td>
		                    <input type="text"
		                        class="form-control form-control-sm col-descrizione"
		                        th:name="'transactions[' + ${iter.index} + '].description'"
		                        th:value="${transaction.description}" />
		                </td>

		                <!-- n° e data doc. -->
		                <td>
		                    <input type="number"
		                        class="form-control form-control-sm"
		                        th:name="'transactions[' + ${iter.index} + '].documentItemNumber'"
		                        th:value="${transaction.documentItemNumber}" />
		                </td>

		                <!-- Voce: select -->
		                <td>
		                    <select class="form-select form-select-sm"
		                        th:name="'transactions[' + ${iter.index} + '].transactionDetailId'">
		                        <option value="">-</option>
		                        <option th:each="detail : ${transactionDetails}"
		                                th:value="${detail.id}"
		                                th:text="${detail.code + ' - ' + detail.description + ' (' + detail.type.name() + ')'}"
		                                th:selected="${transaction.transactionDetail != null and detail.id == transaction.transactionDetail.id}">
		                        </option>
		                    </select>
		                </td>

		                <!-- CASSA ENTRATE (A) -->
		                <td>
		                    <input type="number" step="0.01" min="0"
		                        class="form-control form-control-sm text-end"
		                        th:name="'transactions[' + ${iter.index} + '].cassaEntrate'"
		                        th:value="${transaction.type.name() == 'CASH' and transaction.amount &gt; 0 ? transaction.amount : ''}" />
		                </td>
		                <!-- CASSA USCITE (B) -->
		                <td>
		                    <input type="number" step="0.01" min="0"
		                        class="form-control form-control-sm text-end"
		                        th:name="'transactions[' + ${iter.index} + '].cassaUscite'"
		                        th:value="${transaction.type.name() == 'CASH' and transaction.amount &lt; 0 ? transaction.amount.abs() : ''}" />
		                </td>
		                <!-- BANCA ENTRATE (A) -->
		                <td>
		                    <input type="number" step="0.01" min="0"
		                        class="form-control form-control-sm text-end"
		                        th:name="'transactions[' + ${iter.index} + '].bancaEntrate'"
		                        th:value="${transaction.type.name() == 'BANK' and transaction.amount &gt; 0 ? transaction.amount : ''}" />
		                </td>
		                <!-- BANCA USCITE (B) -->
		                <td>
		                    <input type="number" step="0.01" min="0"
		                        class="form-control form-control-sm text-end"
		                        th:name="'transactions[' + ${iter.index} + '].bancaUscite'"
		                        th:value="${transaction.type.name() == 'BANK' and transaction.amount &lt; 0 ? transaction.amount.abs() : ''}" />
		                </td>
		            </tr>
		        </tbody>
		        
		    </table>
			
			<hr>
			<a th:href="@{/web/cashflow?year={year}(year=${year})}" class="btn btn-secondary fw-bold">Torna senza salvare</a>
			<button type="submit" class="btn btn-secondary fw-bold">Salva modifiche</button>
			<hr>
		    
		</form>
    </main>

    <footer class="mt-auto text-black-50">
        <img th:src="@{/images/logo.jpg}" alt="Mathis Logo" style="width: 30px;">
        <p>Mathis is a open source poject on <a href="https://github.com/gvincenzi/mathis" class="text-black">GitHub</a>, developed by <a
                href="https://www.linkedin.com/in/giuseppevincenzi/?originalSubdomain=fr" class="text-black">Giuseppe Vincenzi</a></p>
    </footer>
</div>
</body>
</html>
