<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org" class="dark h-100" data-bs-theme="dark">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Mathis - Welcome page</title>
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
            crossorigin="anonymous"></script>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" th:href="@{/styles/cashflow.css}"/>

</head>
<body class="d-flex h-100 text-center text-bg-white">

<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header class="mb-auto">
		<img th:src="@{/images/mathis.png}" alt="Mathis Logo" style="width: 150px;">
		<h1>CashFlow</h1>
    </header>

    <main class="px-3">
		<table class="report-table">
		    <thead>
		        <tr>
		            <th>Data Reg.</th>
		            <th>Descrizione</th>
		            <th>n° e data doc.</th>
		            <th>Voce</th>
		            <th class="cassa-entrate-header">CASSA&gt; ENTRATE (A)</th>
		            <th class="cassa-uscite-header">CASSA&gt; USCITE (B)</th>
		            <th class="banca-entrate-header">BANCA&gt; ENTRATE (A)</th>
		            <th class="banca-uscite-header">BANCA&gt; USCITE (B)</th>
		        </tr>
				<tr>
				    <td colspan="4" class="residui-header">Residui anno precedente</td>
				    <td class="residui-value" th:text="${initialCashBalance &gt; 0} ? |€ ${#numbers.formatDecimal(initialCashBalance, 1, 'COMMA', 2, 'POINT')}| : ''"></td>
				    <td class="residui-value" th:text="${initialCashBalance &lt; 0} ? |€ ${#numbers.formatDecimal(initialCashBalance.abs(), 1, 'COMMA', 2, 'POINT')}| : ''"></td>
				    <td class="residui-value" th:text="${initialBankBalance &gt; 0} ? |€ ${#numbers.formatDecimal(initialBankBalance, 1, 'COMMA', 2, 'POINT')}| : ''"></td>
				    <td class="residui-value" th:text="${initialBankBalance &lt; 0} ? |€ ${#numbers.formatDecimal(initialBankBalance.abs(), 1, 'COMMA', 2, 'POINT')}| : ''"></td>
				</tr>

		    </thead>
		    <tbody>
		        <tr th:each="transaction : ${transactions}">
		            <td th:text="${#temporals.format(transaction.date, 'dd-MMM-yy')}"></td>
		            <td th:text="${transaction.description}"></td>
		            <td th:text="${transaction.formattedDocumentNumber}"></td>
		            <td th:text="${transaction.transactionDetail != null ? transaction.transactionDetail.code : ''}"></td>

		            <!-- CASSA ENTRATE (A) -->
		            <td th:if="${transaction.type.name() == 'CASH' and transaction.amount &gt; 0}"
		                class="currency"
		                th:text="|€ ${#numbers.formatDecimal(transaction.amount, 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td th:if="${!(transaction.type.name() == 'CASH' and transaction.amount &gt; 0)}"></td>

		            <!-- CASSA USCITE (B) -->
		            <td th:if="${transaction.type.name() == 'CASH' and transaction.amount &lt; 0}"
		                class="currency uscita"
		                th:text="|€ ${#numbers.formatDecimal(transaction.amount.abs(), 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td th:if="${!(transaction.type.name() == 'CASH' and transaction.amount &lt; 0)}"></td>

		            <!-- BANCA ENTRATE (A) -->
		            <td th:if="${transaction.type.name() == 'BANK' and transaction.amount &gt; 0}"
		                class="currency"
		                th:text="|€ ${#numbers.formatDecimal(transaction.amount, 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td th:if="${!(transaction.type.name() == 'BANK' and transaction.amount &gt; 0)}"></td>

		            <!-- BANCA USCITE (B) -->
		            <td th:if="${transaction.type.name() == 'BANK' and transaction.amount &lt; 0}"
		                class="currency uscita"
		                th:text="|€ ${#numbers.formatDecimal(transaction.amount.abs(), 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td th:if="${!(transaction.type.name() == 'BANK' and transaction.amount &lt; 0)}"></td>
		        </tr>
		    </tbody>
		    <tfoot>
		        <tr>
		            <td colspan="4"></td>
		            <td class="cassa-entrate-total"
		                th:text="|€ ${#numbers.formatDecimal(totalCashEntrate, 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td class="cassa-uscite-total"
		                th:text="|€ ${#numbers.formatDecimal(totalCashUscite, 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td class="banca-entrate-total"
		                th:text="|€ ${#numbers.formatDecimal(totalBankEntrate, 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td class="banca-uscite-total"
		                th:text="|€ ${#numbers.formatDecimal(totalBankUscite, 1, 'COMMA', 2, 'POINT')}|"></td>
		        </tr>
		        <tr>
		            <td colspan="4"></td>
		            <td class="tot-label">TOT. ENTRATE</td>
		            <td class="tot-label">TOT. USCITE</td>
		            <td class="tot-label">TOT. ENTRATE</td>
		            <td class="tot-label">TOT. USCITE</td>
		        </tr>
		        <tr>
		            <td colspan="4"></td>
		            <td class="saldo-header">SALDO (anno corrente)</td>
		            <td class="currency"
		                th:text="|€ ${#numbers.formatDecimal(totalCashEntrate - totalCashUscite, 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td class="saldo-header">SALDO (anno corrente)</td>
		            <td class="currency"
		                th:text="|€ ${#numbers.formatDecimal(totalBankEntrate - totalBankUscite, 1, 'COMMA', 2, 'POINT')}|"></td>
		        </tr>
		        <tr>
		            <td colspan="4"></td>
		            <td class="saldo-header">SALDO (con residuo)</td>
		            <td class="currency"
		                th:text="|€ ${#numbers.formatDecimal((totalCashEntrate - totalCashUscite) + initialCashBalance, 1, 'COMMA', 2, 'POINT')}|"></td>
		            <td class="saldo-header">SALDO (con residuo)</td>
		            <td class="currency"
		                th:text="|€ ${#numbers.formatDecimal((totalBankEntrate - totalBankUscite) + initialBankBalance, 1, 'COMMA', 2, 'POINT')}|"></td>
		        </tr>
		    </tfoot>
		</table>

		<hr>
		<a th:href="@{/web/cashflow/edit?year={year}(year=${year})}" class="btn btn-secondary fw-bold">Modifica la tabella</a>
		<a th:href="@{/api/finance/export/{year}(year=${year})}" class="btn btn-secondary fw-bold">Genera l'excel</a>
		<hr>
    </main>

    <footer class="mt-auto text-black-50">
		<img th:src="@{/images/logo.jpg}" alt="Mathis Logo" style="width: 30px;">
        <p>Mathis is a open source poject on <a href="https://github.com/gvincenzi/mathis" class="text-black">GitHub</a>, developed by <a
                href="https://www.linkedin.com/in/giuseppevincenzi/?originalSubdomain=fr" class="text-black">Giuseppe Vincenzi</a></p>
    </footer>
</div>


</body>
</html>